; All the Recipes

(define recipes (arr-new 256))
(define recipe-new-id)
(let ((recipe-cur-id 0))
	(set! recipe-new-id (λ () "Returns an unused item ID"
		(set! recipe-cur-id (+ recipe-cur-id 1)) (- recipe-cur-id 1))))

(define recipe-sync (λ (obj) "Syncs the Recipe with the ω OBJ"
	(r-result (obj id)  (resolve (obj result-id  )) (obj result-amt  ))
	(r-ingred (obj id) 0 (resolve (obj ingred-id-0)) (obj ingred-amt-0))
	(r-ingred (obj id) 1 (resolve (obj ingred-id-1)) (obj ingred-amt-1))
	(r-ingred (obj id) 2 (resolve (obj ingred-id-2)) (obj ingred-amt-2))
	(r-ingred (obj id) 3 (resolve (obj ingred-id-3)) (obj ingred-amt-3))

	(arr-set! recipes (obj id) obj)))

(define recipe-sync-all (λ (i) "Syncs all Recipes with their respective ω"
	(cond ((nil? (arr-ref recipes i)) #t)
	      (#t (recipe-sync (arr-ref recipes i)) (recipe-sync-all (+ i 1))))))


(define recipe-craft (λ (id times) "Crafts recipe with ID"
	((arr-ref recipes id) craft)))

(define recipe-default (ω ()
	(define id -1)

	(define ingred-id-0 0)
	(define ingred-amt-0 0)
	(define ingred-id-1 0)
	(define ingred-amt-1 0)
	(define ingred-id-2 0)
	(define ingred-amt-2 0)
	(define ingred-id-3 0)
	(define ingred-amt-3 0)

	(define craft (δ () (say "I got nothing to do")))

	(define result-amt 0)
	(define result-id 0)))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-oak-log)
	(define ingred-amt-0 1)
	(define result-id 'i-boards) (define result-amt 2))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-oak-log)
	(define ingred-amt-0 4)
	(define result-id 'i-coal)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  2)
	(define ingred-id-1 'i-stone)
	(define ingred-amt-1  3)
	(define ingred-id-2 'i-plantmatter)
	(define ingred-amt-2  2)
	(define result-id 'i-stoneaxe)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  2)
	(define ingred-id-1 'i-stone)
	(define ingred-amt-1  4)
	(define ingred-id-2 'i-plantmatter)
	(define ingred-amt-2  2)
	(define result-id 'i-stonepickaxe)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  4)
	(define ingred-id-1 'i-stone)
	(define ingred-amt-1  2)
	(define ingred-id-2 'i-plantmatter)
	(define ingred-amt-2  2)
	(define result-id 'i-stonespear)
	(define result-amt 1))))


(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  2)
	(define ingred-id-1 'i-stone)
	(define ingred-amt-1  1)
	(define ingred-id-2 'i-plantmatter)
	(define ingred-amt-2  8)
	(define result-id 'i-flamestick)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  16)
	(define ingred-id-1 'i-fur)
	(define ingred-amt-1  8)
	(define result-id 'i-glider)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-boards)
	(define ingred-amt-0  16)
	(define ingred-id-1 'i-straw)
	(define ingred-amt-1  32)
	(define result-id 'i-glider)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-hematite-ore)
	(define ingred-amt-0  1)
	(define result-id 'i-irondust)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-stone)
	(define ingred-amt-1  2)
	(define result-id 'i-flintandsteel)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  8)
	(define ingred-id-1 'i-coal)
	(define ingred-amt-1  2)
	(define result-id 'i-hook)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-stoneaxe)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  4)
	(define ingred-id-2 'i-coal)
	(define ingred-amt-2  2)
	(define result-id 'i-ironaxe)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-stonepickaxe)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  4)
	(define ingred-id-2 'i-coal)
	(define ingred-amt-2  2)
	(define result-id 'i-ironpickaxe)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-stonespear)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  4)
	(define ingred-id-2 'i-coal)
	(define ingred-amt-2  2)
	(define result-id 'i-ironspear)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystals)
	(define ingred-amt-0  1)
	(define result-id 'i-crystaldust)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironaxe)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-crystalbar)
	(define ingred-amt-1  4)
	(define result-id 'i-crystalaxe)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironpickaxe)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-crystalbar)
	(define ingred-amt-1  4)
	(define result-id 'i-crystalpickax)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironspear)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-crystalbar)
	(define ingred-amt-1  4)
	(define result-id 'i-crystalspear)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  2)
	(define ingred-id-1 'i-coal)
	(define ingred-amt-1  6)
	(define ingred-id-2 'i-crystals)
	(define ingred-amt-2  1)
	(define result-id 'i-grenade)
	(define result-amt 4))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-coal)
	(define ingred-amt-1  4)
	(define ingred-id-2 'i-crystals)
	(define ingred-amt-2  3)
	(define result-id 'i-bomb)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  4)
	(define ingred-id-1 'i-coal)
	(define ingred-amt-1  16)
	(define ingred-id-2 'i-crystals)
	(define ingred-amt-2  8)
	(define result-id 'i-clusterbomb)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-ironbar)
	(define ingred-amt-0  2)
	(define ingred-id-1 'i-coal)
	(define ingred-amt-1  4)
	(define result-id 'i-flamebullet)
	(define result-amt 30))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  8)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  6)
	(define ingred-id-2 'i-flamebullet)
	(define ingred-amt-2 24)
	(define result-id 'i-assaultblaste)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  12)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  16)
	(define ingred-id-2 'i-crystalbulle)
	(define ingred-amt-2  60)
	(define result-id 'i-shotgun)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  4)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1 16)
	(define ingred-id-2 'i-flamebullet)
	(define ingred-amt-2 12)
	(define result-id 'i-waterthrower)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  8)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  8)
	(define ingred-id-2 'i-flamebullet)
	(define ingred-amt-2 16)
	(define result-id 'i-flamethrower)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystals)
	(define ingred-amt-0  1)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  2)
	(define ingred-id-2 'i-coal)
	(define ingred-amt-2  4)
	(define result-id 'i-crystalbulle)
	(define result-amt 30))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  3)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  6)
	(define ingred-id-2 'i-crystalbulle)
	(define ingred-amt-2 12)
	(define result-id 'i-blaster)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  16)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  24)
	(define ingred-id-2 'i-crystalbulle)
	(define ingred-amt-2  90)
	(define result-id 'i-masterblaster)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-crystalbar)
	(define ingred-amt-0  16)
	(define ingred-id-1 'i-ironbar)
	(define ingred-amt-1  16)
	(define ingred-id-2 'i-coal)
	(define ingred-amt-2  32)
	(define result-id 'i-jetpack)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-marble-block)
	(define ingred-amt-0 1)
	(define result-id 'i-marble-pillar)
	(define result-amt 1))))

(recipe-sync (recipe-default (ω ()
	(define id (recipe-new-id))
	(define ingred-id-0 'i-marble-block)
	(define ingred-amt-0 1)
	(define result-id 'i-marble-blocks)
	(define result-amt 1))))

(event-bind "on-init" (λ () ""
	(recipe-sync-all)
	(log (ansi-green "Recipes initialized"))
))
